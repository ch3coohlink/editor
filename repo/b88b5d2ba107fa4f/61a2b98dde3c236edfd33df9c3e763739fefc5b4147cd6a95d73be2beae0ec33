{"id":"61a2b98dde3c236edfd33df9c3e763739fefc5b4147cd6a95d73be2beae0ec33","to":[],"value":"// 这个文件用于调查monaco editor的内存泄露\r\n\r\nconst dom = (t = 'div') => document.createElement(t)\r\nconst newme = () => {\r\n  const top = dom()\r\n  const sroot = top.attachShadow({ mode: \"open\" })\r\n  const css = dom(\"style\")\r\n  css.innerText = `@import \"${$$.monaco_root}/editor/editor.main.css\";`\r\n  const div = dom()\r\n  div.className = 'monaco-editor-div'\r\n  top.style.height = '100px'\r\n  div.style.height = '100%'\r\n  sroot.append(div, css)\r\n  root.append(top)\r\n\r\n  const e = monaco.editor.create(div, {\r\n    value: \"console.log('hello')\",\r\n    language: \"javascript\",\r\n    theme: \"vs-light\",\r\n    renderWhitespace: \"all\",\r\n    renderControlCharacters: true,\r\n    lightbulb: { enabled: false },\r\n    tabSize: 2,\r\n    cursorBlinking: \"smooth\",\r\n    cursorSmoothCaretAnimation: \"on\",\r\n    smoothScrolling: true,\r\n    wordBasedSuggestions: 'off',\r\n  })\r\n  const dispose = () => {\r\n    top.remove()\r\n    top.innerHTML = ''\r\n    e.dispose()\r\n    // en.unregistersandboxclear()\r\n  }\r\n  setTimeout(dispose, 1000)\r\n  const en = $$.eventnode()\r\n  en.dispose = dispose\r\n  $$.sandboxtab.registerclear(en)\r\n  en.registersandboxclear($)\r\n\r\n  $$.ongc(top, 'test-top', true)\r\n  $$.ongc(e, 'monaco-editor', true)\r\n}\r\n// newme()\r\nsetInterval(newme, 50)"}