{"id":"28c025d89c484de845f823ebe111286bab4ac31993a1641bdbf5afc43c6edf70","to":[],"value":"$.jsmime = 'application/javascript'\r\n$.bootworker = (src, url) => {\r\n  url ??= URL.createObjectURL(new Blob([src], { type: jsmime }))\r\n  return new Worker(url)\r\n}\r\n// 这段代码在sandbox未正常释放的时候会导致worker无法被GC\r\n// 甚至更奇怪的是，sandbox本身由于不明原因也不会被GC\r\n// 但是这也意味着原本对文件的监听还是存在，修改文件仍然会让sandbox正常GC\r\nbootworker(`setInterval(() => console.log('worker'), 500)`)\r\n\r\n// 补充：我现在修改了sandbox的机制，\r\n// 它会每隔一段时间检查sandbox是不是在dom\r\n// 如果不在就自动执行清除\r\n// 因此就能保证worker一定会被及时回收\r\n\r\n// 补充的补充：经过调查，发现有monaco editor存在的tab就无法正常内存回收"}